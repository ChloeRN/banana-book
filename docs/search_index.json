[["index.html", "Bayesian Analysis of Capture-Recapture Data with Hidden Markov Models – Theory and Case Studies in R Welcome", " Bayesian Analysis of Capture-Recapture Data with Hidden Markov Models – Theory and Case Studies in R Olivier Gimenez 2021-08-26 Welcome Welcome to the website of the book Bayesian Analysis of Capture-Recapture Data with Hidden Markov Models – Theory and Case Studies in R by Olivier Gimenez. Note that the book is also available in PDF format. I’m currently writing this book, and I welcome any feedback or requests for content here. Many thanks! Last updated: August 26, 2021 "],["preface.html", "Preface Why read this book Structure of the book Software information and conventions Acknowledgments", " Preface The HMM framework has gained much attention in the ecological literature over the last decade, and has been suggested as a general modelling framework for the demography of plant and animal populations. In particular, HMMs are increasingly used to analyse capture-recapture data and estimate key population parameters (e.g., survival, dispersal, recruitment or abundance) with applications all fields of ecology. In parallel, Bayesian statistics is relatively well established and fast growing in ecology and related disciplines, because it resonates with scientific reasoning and allows accommodating uncertainty smoothly. The popularity of Bayesian statistics also comes from the availability of free pieces of software (WinBUGS, OpenBUGS, JAGS, Stan, nimble) that allow practitioners to code their own analyses. However, to my knowledge, a full Bayesian treatment of HMMs applied to capture-recapture data is yet to be proposed in a book. This is what I propose with this book. Besides, the popular software solutions come with computational limitations when ecologists have to deal with complex models and/or big data. I will use Nimble that is seen by many as the future of ecological data modelling because it extends the BUGS language for writing new functions and distributions, and provides samplers that can deal with discrete latent states in contrast with Stan. In this book, I will cover both the theory of HMMs for capture-recapture data, and the applications of these models to empower practitioners to fit their models with confidence. An important part of the book will consist in case studies presented in a tutorial style to abide by the “learning by doing” philosophy. The online version of this book is licensed under the Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. Why read this book Structure of the book Blabla. Software information and conventions This book uses primarily the R package nimble, so you need to at least install R and the nimble package. The R session information when compiling this book is shown below: sessionInfo() ## R version 4.1.0 (2021-05-18) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Catalina 10.15.7 ## ## Matrix products: default ## BLAS: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.dylib ## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib ## ## locale: ## [1] fr_FR.UTF-8/fr_FR.UTF-8/fr_FR.UTF-8/C/C/fr_FR.UTF-8 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets ## [6] methods base ## ## loaded via a namespace (and not attached): ## [1] bookdown_0.23 digest_0.6.27 ## [3] R6_2.5.0 jsonlite_1.7.2 ## [5] magrittr_2.0.1 evaluate_0.14 ## [7] stringi_1.7.3 rlang_0.4.11 ## [9] rstudioapi_0.13 jquerylib_0.1.4 ## [11] bslib_0.2.5.1 rmarkdown_2.10 ## [13] tools_4.1.0 stringr_1.4.0 ## [15] xfun_0.25 yaml_2.2.1 ## [17] compiler_4.1.0 htmltools_0.5.1.1 ## [19] knitr_1.33 sass_0.4.0 We do not add prompts (&gt; and +) to R source code in this book, and we comment out the text output with two hashes ## by default, as you can see from the R session information above. This is for your convenience when you want to copy and run the code (the text output will be ignored since it is commented out). Package names are in bold text (e.g., nimble), and inline code and filenames are formatted in a typewriter font (e.g., knitr::knit('foo.Rmd')). Function names are followed by parentheses (e.g., nimble::nimbleCode()). The double-colon operator :: means accessing an object from a package. Acknowledgments CNRS. Jean-Do. Roger. Rémi. My students. Chloé, Sarah, Perry, Daniel. Rob Chapman &amp; Hall/CRC. Workshop attendees. Feedback from. FIP radio. Marc Kéry for his support and advice on how to write a book. Proofreading by. My family. Olivier Gimenez Montpellier, France "],["about-the-author.html", "About the Author", " About the Author Je m’appelle Olivier Gimenez (https://oliviergimenez.github.io/). Je suis directeur de recherche au CNRS. Après des études universitaires en mathématiques, j’ai fait une thèse en statistiques pour l’écologie. J’ai passé mon Habilitation à Diriger des Recherches en écologie et évolution. Récemment, je suis retourné sur les bancs de l’université pour m’initier à la sociologie. J’ai écrit des articles scientifiques faisant appel à la statistique bayésienne, et co-écrit avec des collègues britanniques un livre sur les analyses bayésiennes pour l’écologie des populations. Vous pouvez me retrouver sur Twitter (https://twitter.com/oaggimenez), ou bien me contacter via mon adresse email qui s’écrit olivier suivi d’un point puis gimenez, ensuite arobase, puis cefe, suivi d’un point, puis cnrs, suivi d’un point et pour terminer fr. Tombé dedans quand j’étais petit. Obélix Roger et Astérix JD. "],["crashcourse.html", "Chapter 1 Bayesian statistics &amp; MCMC 1.1 Bayes’ theorem 1.2 Frequentist versus Bayesian 1.3 What is the Bayesian approach? 1.4 Bayes’ theorem 1.5 Brute force via numerical integration 1.6 Further reading", " Chapter 1 Bayesian statistics &amp; MCMC 1.1 Bayes’ theorem A theorem about conditional probabilities. \\(\\Pr(B \\mid A) = \\displaystyle{\\frac{ \\Pr(A \\mid B) \\; \\Pr(B)}{\\Pr(A)}}\\) Figure 1.1: Bayes’ theorem spelt out in blue neon at the offices of Autonomy in Cambridge. Source: Wikipedia I always forget what the letters mean. Might be easier to remember when written like this: \\[ \\Pr(\\text{hypothesis} \\mid \\text{data}) = \\frac{ \\Pr(\\text{data} \\mid \\text{hypothesis}) \\; \\Pr(\\text{hypothesis})}{\\Pr(\\text{data})} \\] The “hypothesis” is typically something unobserved or unknown. It’s what you want to learn about using the data. For regression models, the “hypothesis” is a parameter (intercept, slopes or error terms). Bayes theorem tells you the probability of the hypothesis given the data. Cool because what is doing science after all? How plausible is some hypothesis given the data? \\[ \\Pr(\\text{hypothesis} \\mid \\text{data}) = \\frac{ \\Pr(\\text{data} \\mid \\text{hypothesis}) \\; \\Pr(\\text{hypothesis})}{\\Pr(\\text{data})} \\] The Bayesian reasoning echoes the scientific reasoning. You might ask then, why is Bayesian statistics not the default? You may ask: Why is Bayesian statistics not the default? Due to practical problems of implementing the Bayesian approach, and futile wars between (male) statisticians, little progress was made for over two centuries. Recent advances in computational power coupled with the development of new methodology have led to a great increase in the application of Bayesian methods within the last two decades. 1.2 Frequentist versus Bayesian Typical stats problems involve estimating parameter \\(\\theta\\) with available data. The frequentist approach (maximum likelihood estimation – MLE) assumes that the parameters are fixed, but have unknown values to be estimated. Classical estimates are generally point estimates of the parameters of interest. The Bayesian approach assumes that the parameters are not fixed but have some fixed unknown distribution - a distribution for the parameter. 1.3 What is the Bayesian approach? The approach is based upon the idea that the experimenter begins with some prior beliefs about the system. You never start from scratch. And then updates these beliefs on the basis of observed data. This updating procedure is based upon the Bayes’ Theorem: \\[\\Pr(A \\mid B) = \\frac{\\Pr(B \\mid A) \\; \\Pr(A)}{\\Pr(B)}\\] Schematically if \\(A = \\theta\\) and \\(B = \\text{data}\\), then The Bayes’ theorem \\[\\Pr(A \\mid B) = \\frac{\\Pr(B \\mid A) \\; \\Pr(A)}{\\Pr(B)}\\] Translates into: \\[\\Pr(\\theta \\mid \\text{data}) = \\frac{\\Pr(\\text{data} \\mid \\theta) \\; \\Pr(\\theta)}{\\Pr(\\text{data})}\\] 1.4 Bayes’ theorem \\[{\\color{red}{\\Pr(\\theta \\mid \\text{data})}} = \\frac{\\color{blue}{\\Pr(\\text{data} \\mid \\theta)} \\; \\color{green}{\\Pr(\\theta)}}{\\color{orange}{\\Pr(\\text{data})}}\\] \\(\\color{red}{\\text{Posterior distribution}}\\): Represents what you know after having seen the data. The basis for inference, a distribution, possibly multivariate if more than one parameter. \\(\\color{blue}{\\text{Likelihood}}\\): This quantity is the same as in the MLE approach. \\(\\color{green}{\\text{Prior distribution}}\\): Represents what you know before seeing the data. The source of much discussion about the Bayesian approach. \\(\\color{orange}{\\Pr(\\text{data}) = \\int{L(\\text{data} \\mid \\theta)\\Pr(\\theta) d\\theta}}\\) is a \\(N\\)-dimensional integral if \\(\\theta = \\theta_1, \\ldots, \\theta_N\\). Difficult if not impossible to calculate. This is one of the reasons why we need simulation (MCMC) methods. 1.5 Brute force via numerical integration Say we release \\(n\\) animals at the beginning of the winter, out of which \\(y\\) survive, and we’d like to estimate winter survival \\(\\theta\\). y &lt;- 19 # nb of success n &lt;- 57 # nb of attempts 1.6 Further reading McCarthy, M. (2007). Bayesian Methods for Ecology. Cambridge: Cambridge University Press. McElreath, R. (2020). Statistical Rethinking: A Bayesian Course with Examples in R and Stan (2nd ed.). CRC Press. Gelman, A. and Hill, J. (2006). Data Analysis Using Regression and Multilevel/Hierarchical Models (Analytical Methods for Social Research). Cambridge: Cambridge University Press. "],["intronimble.html", "Chapter 2 Introduction to Nimble", " Chapter 2 Introduction to Nimble Blabla. \\(x + 2 = 5\\) "],["hmmcapturerecapture.html", "Chapter 3 Hidden Markov models", " Chapter 3 Hidden Markov models Heller and Pogaru (2021) References "],["survival.html", "Chapter 4 Survival", " Chapter 4 Survival "],["transition.html", "Chapter 5 Transition", " Chapter 5 Transition "],["covariates.html", "Chapter 6 Covariates", " Chapter 6 Covariates "],["uncertainty.html", "Chapter 7 Uncertainty in state assignment", " Chapter 7 Uncertainty in state assignment "],["abundance.html", "Chapter 8 Abundance", " Chapter 8 Abundance "],["hsmm.html", "Chapter 9 Hidden semi-Markov models", " Chapter 9 Hidden semi-Markov models "],["states.html", "Chapter 10 Hidden states", " Chapter 10 Hidden states "],["speed.html", "Chapter 11 Speed up MCMC", " Chapter 11 Speed up MCMC "],["senescence.html", "Chapter 12 Actuarial senescence", " Chapter 12 Actuarial senescence Choquet et al. (2011), Péron et al. (2016) References "],["heterogeneity.html", "Chapter 13 Individual heterogeneity", " Chapter 13 Individual heterogeneity Cubaynes et al. (2010), Gimenez and Choquet (2010), and Turek, Wehrhahn, and Gimenez (2021) References "],["tradeoffs.html", "Chapter 14 Life-history tradeoffs", " Chapter 14 Life-history tradeoffs Morano et al. (2013), Shefferson et al. (2003), and Cruz-Flores et al. (n.d.) References "],["breeding.html", "Chapter 15 Breeding dynamics", " Chapter 15 Breeding dynamics Pradel, Choquet, and Béchet (2012), Desprez et al. (2011), Desprez et al. (2013), and Pacoureau et al. (2019) References "],["rd.html", "Chapter 16 Robust design", " Chapter 16 Robust design Karamanlidis et al. (2015), Santostasi et al. (2016), Gibson et al. (2018), and Rankin et al. (2016) References "],["stopover.html", "Chapter 17 Stopover duration", " Chapter 17 Stopover duration Guérin et al. (2017) References "],["disease.html", "Chapter 18 Disease dynamics", " Chapter 18 Disease dynamics Marescot et al. (2018) and Santoro et al. (2014) References "],["sex.html", "Chapter 19 Sex uncertainty", " Chapter 19 Sex uncertainty Pradel et al. (2008) and Genovart, Pradel, and Oro (2012) References "],["dependence.html", "Chapter 20 Dependence among individuals", " Chapter 20 Dependence among individuals Culina et al. (2013) and Cubaynes et al. (2021) References "],["covariateselection.html", "Chapter 21 Individual and temporal variability", " Chapter 21 Individual and temporal variability Grosbois et al. (2008), Cubaynes et al. (2012), Gimenez et al. (2006), and Bonner, Morgan, and King (2010) References "],["mortalities.html", "Chapter 22 Cause-specific mortalities", " Chapter 22 Cause-specific mortalities Fernández-Chacón et al. (2016) and Ruette et al. (2015) References "],["prevalence.html", "Chapter 23 Prevalence", " Chapter 23 Prevalence (Santostasi et al. 2019) References "],["faq.html", "FAQ", " FAQ Below is the complete list of frequently asked questions (FAQ). Yes, there is only one question here. Personally I do not like FAQs. They often mean surprises, and surprises are not good for software users. Q: Will bookdown have the features X, Y, and Z? A: The short answer is no, but if you have asked yourself three times “do I really need them” and the answer is still “yes,” please feel free to file a feature request to https://github.com/rstudio/bookdown/issues. Users asking for more features often come from the LaTeX world. If that is the case for you, the answer to this question is yes, because Pandoc’s Markdown supports raw LaTeX code. Whenever you feel Markdown cannot do the job for you, you always have the option to apply some raw LaTeX code in your Markdown document. For example, you can create glossaries using the glossaries package, or embed a complicated LaTeX table, as long as you know the LaTeX syntax. However, please keep in mind that the LaTeX content is not portable. It will only work for LaTeX/PDF output, and will be ignored in other types of output. Depending on the request, we may port a few more LaTeX features into bookdown in the future, but our general philosophy is that Markdown should be kept as simple as possible. The most challenging thing in the world is not to learn fancy technologies, but control your own wild heart. "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
